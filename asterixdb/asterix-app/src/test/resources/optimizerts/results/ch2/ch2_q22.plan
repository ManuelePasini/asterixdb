distribute result [$$135]
-- DISTRIBUTE_RESULT  |PARTITIONED|
  exchange
  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
    project ([$$135])
    -- STREAM_PROJECT  |PARTITIONED|
      assign [$$135] <- [{"country": $#1, "numcust": $$144, "totacctbal": $$145}]
      -- ASSIGN  |PARTITIONED|
        exchange
        -- SORT_MERGE_EXCHANGE [$#1(ASC) ]  |PARTITIONED|
          group by ([$#1 := $$168]) decor ([]) {
                    aggregate [$$144, $$145] <- [agg-sql-sum($$166), agg-global-sql-sum($$167)]
                    -- AGGREGATE  |LOCAL|
                      nested tuple source
                      -- NESTED_TUPLE_SOURCE  |LOCAL|
                 }
          -- SORT_GROUP_BY[$$168]  |PARTITIONED|
            exchange
            -- HASH_PARTITION_EXCHANGE [$$168]  |PARTITIONED|
              group by ([$$168 := $$136]) decor ([]) {
                        aggregate [$$166, $$167] <- [agg-sql-count(1), agg-local-sql-sum($$146)]
                        -- AGGREGATE  |LOCAL|
                          nested tuple source
                          -- NESTED_TUPLE_SOURCE  |LOCAL|
                     }
              -- SORT_GROUP_BY[$$136]  |PARTITIONED|
                exchange
                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                  project ([$$146, $$136])
                  -- STREAM_PROJECT  |PARTITIONED|
                    assign [$$136] <- [substring1($$157, 1, 1)]
                    -- ASSIGN  |PARTITIONED|
                      project ([$$146, $$157])
                      -- STREAM_PROJECT  |PARTITIONED|
                        select (not(neq($$143, 0)))
                        -- STREAM_SELECT  |PARTITIONED|
                          project ([$$143, $$146, $$157])
                          -- STREAM_PROJECT  |PARTITIONED|
                            exchange
                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                              group by ([$$162 := $$165]) decor ([$$146; $$157]) {
                                        aggregate [$$143] <- [agg-sum($$164)]
                                        -- AGGREGATE  |LOCAL|
                                          nested tuple source
                                          -- NESTED_TUPLE_SOURCE  |LOCAL|
                                     }
                              -- SORT_GROUP_BY[$$165]  |PARTITIONED|
                                exchange
                                -- HASH_PARTITION_EXCHANGE [$$165]  |PARTITIONED|
                                  group by ([$$165 := $$160]) decor ([$$146; $$157]) {
                                            aggregate [$$164] <- [agg-count(1)]
                                            -- AGGREGATE  |LOCAL|
                                              select (not(is-missing($$161)))
                                              -- STREAM_SELECT  |LOCAL|
                                                nested tuple source
                                                -- NESTED_TUPLE_SOURCE  |LOCAL|
                                         }
                                  -- PRE_CLUSTERED_GROUP_BY[$$160]  |PARTITIONED|
                                    exchange
                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                      order (ASC, $$160)
                                      -- STABLE_SORT [$$160(ASC)]  |PARTITIONED|
                                        exchange
                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                          project ([$$146, $$157, $$161, $$160])
                                          -- STREAM_PROJECT  |PARTITIONED|
                                            exchange
                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                              left outer join (and(eq($$148, $$149), eq($$150, $$151), eq($$152, $$153)))
                                              -- HYBRID_HASH_JOIN [$$149, $$151, $$153][$$148, $$150, $$152]  |PARTITIONED|
                                                exchange
                                                -- HASH_PARTITION_EXCHANGE [$$149, $$151, $$153]  |PARTITIONED|
                                                  running-aggregate [$$160] <- [create-query-uid()]
                                                  -- RUNNING_AGGREGATE  |PARTITIONED|
                                                    project ([$$146, $$157, $$149, $$151, $$153])
                                                    -- STREAM_PROJECT  |PARTITIONED|
                                                      exchange
                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                        join (gt($$146, $$147))
                                                        -- NESTED_LOOP  |PARTITIONED|
                                                          exchange
                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                            project ([$$146, $$157, $$149, $$151, $$153])
                                                            -- STREAM_PROJECT  |PARTITIONED|
                                                              exchange
                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                join (eq($$141, $$79))
                                                                -- HYBRID_HASH_JOIN [$$79][$$141]  |PARTITIONED|
                                                                  exchange
                                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                    project ([$$146, $$157, $$149, $$151, $$153, $$79])
                                                                    -- STREAM_PROJECT  |PARTITIONED|
                                                                      assign [$$79, $$157, $$153, $$151, $$149, $$146] <- [substring1($$c.getField("c_phone"), 1, 1), $$c.getField("c_state"), $$c.getField("c_w_id"), $$c.getField("c_id"), $$c.getField("c_d_id"), $$c.getField("c_balance")]
                                                                      -- ASSIGN  |PARTITIONED|
                                                                        project ([$$c])
                                                                        -- STREAM_PROJECT  |PARTITIONED|
                                                                          assign [$$c] <- [$$c1]
                                                                          -- ASSIGN  |PARTITIONED|
                                                                            exchange
                                                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                              replicate
                                                                              -- REPLICATE  |PARTITIONED|
                                                                                exchange
                                                                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                  project ([$$c1])
                                                                                  -- STREAM_PROJECT  |PARTITIONED|
                                                                                    exchange
                                                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                      data-scan []<-[$$139, $$c1] <- test.customer
                                                                                      -- DATASOURCE_SCAN  |PARTITIONED|
                                                                                        exchange
                                                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                          empty-tuple-source
                                                                                          -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                                                  exchange
                                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                    project ([$$141])
                                                                    -- STREAM_PROJECT  |PARTITIONED|
                                                                      assign [$$141] <- [$$142]
                                                                      -- ASSIGN  |PARTITIONED|
                                                                        exchange
                                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                          replicate
                                                                          -- REPLICATE  |PARTITIONED|
                                                                            exchange
                                                                            -- BROADCAST_EXCHANGE  |PARTITIONED|
                                                                              unnest $$142 <- scan-collection(array: [ "1", "2", "3", "4", "5", "6", "7" ])
                                                                              -- UNNEST  |UNPARTITIONED|
                                                                                empty-tuple-source
                                                                                -- EMPTY_TUPLE_SOURCE  |UNPARTITIONED|
                                                          exchange
                                                          -- BROADCAST_EXCHANGE  |PARTITIONED|
                                                            project ([$$147])
                                                            -- STREAM_PROJECT  |UNPARTITIONED|
                                                              assign [$$147] <- [get-item($$98, 0)]
                                                              -- ASSIGN  |UNPARTITIONED|
                                                                aggregate [$$98] <- [listify($$163)]
                                                                -- AGGREGATE  |UNPARTITIONED|
                                                                  aggregate [$$163] <- [agg-global-sql-avg($$169)]
                                                                  -- AGGREGATE  |UNPARTITIONED|
                                                                    exchange
                                                                    -- RANDOM_MERGE_EXCHANGE  |PARTITIONED|
                                                                      aggregate [$$169] <- [agg-local-sql-avg($$155)]
                                                                      -- AGGREGATE  |PARTITIONED|
                                                                        project ([$$155])
                                                                        -- STREAM_PROJECT  |PARTITIONED|
                                                                          exchange
                                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                            join (eq($$142, $$87))
                                                                            -- HYBRID_HASH_JOIN [$$87][$$142]  |PARTITIONED|
                                                                              exchange
                                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                project ([$$155, $$87])
                                                                                -- STREAM_PROJECT  |PARTITIONED|
                                                                                  assign [$$87] <- [substring1($$c1.getField("c_phone"), 1, 1)]
                                                                                  -- ASSIGN  |PARTITIONED|
                                                                                    select (gt($$155, 0.0))
                                                                                    -- STREAM_SELECT  |PARTITIONED|
                                                                                      assign [$$155] <- [$$c1.getField("c_balance")]
                                                                                      -- ASSIGN  |PARTITIONED|
                                                                                        exchange
                                                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                          replicate
                                                                                          -- REPLICATE  |PARTITIONED|
                                                                                            exchange
                                                                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                              project ([$$c1])
                                                                                              -- STREAM_PROJECT  |PARTITIONED|
                                                                                                exchange
                                                                                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                  data-scan []<-[$$139, $$c1] <- test.customer
                                                                                                  -- DATASOURCE_SCAN  |PARTITIONED|
                                                                                                    exchange
                                                                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                      empty-tuple-source
                                                                                                      -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                                                              exchange
                                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                replicate
                                                                                -- REPLICATE  |PARTITIONED|
                                                                                  exchange
                                                                                  -- BROADCAST_EXCHANGE  |PARTITIONED|
                                                                                    unnest $$142 <- scan-collection(array: [ "1", "2", "3", "4", "5", "6", "7" ])
                                                                                    -- UNNEST  |UNPARTITIONED|
                                                                                      empty-tuple-source
                                                                                      -- EMPTY_TUPLE_SOURCE  |UNPARTITIONED|
                                                exchange
                                                -- HASH_PARTITION_EXCHANGE [$$148, $$150, $$152]  |PARTITIONED|
                                                  assign [$$161] <- [true]
                                                  -- ASSIGN  |PARTITIONED|
                                                    project ([$$152, $$150, $$148])
                                                    -- STREAM_PROJECT  |PARTITIONED|
                                                      select (and(ge($$137, "2013-12-01 00:00:00"), le($$137, "2013-12-31 00:00:00")))
                                                      -- STREAM_SELECT  |PARTITIONED|
                                                        project ([$$152, $$150, $$148, $$137])
                                                        -- STREAM_PROJECT  |PARTITIONED|
                                                          assign [$$152, $$150, $$148, $$137] <- [$$o.getField("o_w_id"), $$o.getField("o_c_id"), $$o.getField("o_d_id"), $$o.getField("o_entry_d")]
                                                          -- ASSIGN  |PARTITIONED|
                                                            project ([$$o])
                                                            -- STREAM_PROJECT  |PARTITIONED|
                                                              exchange
                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                data-scan []<-[$$140, $$o] <- test.orders
                                                                -- DATASOURCE_SCAN  |PARTITIONED|
                                                                  exchange
                                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                    empty-tuple-source
                                                                    -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
